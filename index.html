<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>riziqstore.idn - Top Up Games</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        body{background:#0f172a;color:#e2e8f0;font-family:Inter}
        .navbar{background:#1e293b;border-bottom:1px solid #334155}
        .brand-logo{font-weight:800;font-size:1.4rem;color:white}
        .brand-accent{color:#38bdf8}
        .game-grid-card{background:#1e293b;border:1px solid #334155;border-radius:14px;cursor:pointer;overflow:hidden}
        .game-grid-card:hover{border-color:#38bdf8;transform:translateY(-4px)}
        .game-img-wrapper{aspect-ratio:1/1}
        .game-img-wrapper img{width:100%;height:100%;object-fit:cover}
        .game-title{text-align:center;padding:8px;font-weight:700}
        .main-card{background:#1e293b;border-radius:16px;border:1px solid #334155}
        .item-card{background:#0f172a;border:2px solid #334155;border-radius:12px;padding:12px;cursor:pointer}
        .item-card.active{border-color:#38bdf8;background:rgba(56,189,248,.08)}
        .btn-pay{background:linear-gradient(135deg,#0ea5e9,#2563eb);border:none;border-radius:12px;padding:14px;font-weight:700;width:100%}
    </style>
</head>

<body>
    <nav class="navbar sticky-top">
        <div class="container justify-content-center">
            <img src="assets/logo.png" style="width:40px;height:40px;border-radius:50%;margin-right:8px">
            <span class="brand-logo">riziqstore<span class="brand-accent">.idn</span></span>
        </div>
    </nav>

    <div class="container mt-4" style="max-width:500px">

        <!-- HOME -->
        <div id="homePage">
            <h5 class="text-center mb-3">Mau Top Up Apa Hari Ini?</h5>
            <div class="row g-3" id="gameGridContainer"></div>
        </div>

        <!-- ORDER -->
        <div id="orderPage" style="display:none">
        <button class="btn btn-sm btn-secondary mb-2" onclick="backToHome()">
            <i class="fa fa-arrow-left"></i> Kembali
        </button>

        <div id="storeStatus" class="alert text-center mb-2">Checking...</div>

        <div class="main-card p-3">
            <div class="text-center mb-3">
                <img id="selectedGameImg" style="width:60px;height:60px;border-radius:10px">
                <h6 id="selectedGameTitle" class="mt-2"></h6>
            </div>

            <!-- METODE -->
            <div class="btn-group w-100 mb-3">
                <input type="radio" class="btn-check" name="metode" id="metodeUid" checked onchange="toggleMetode()">
                <label class="btn btn-outline-primary" for="metodeUid">Via ID</label>
                <input type="radio" class="btn-check" name="metode" id="metodeLogin" onchange="toggleMetode()">
                <label class="btn btn-outline-primary" for="metodeLogin">Via Login</label>
            </div>

            <!-- UID -->
            <div id="formUid">
                <div class="row g-2">
                    <div class="col-8" id="colUserId"><input id="userId" class="form-control" placeholder="User ID"></div>
                    <div class="col-4" id="colZoneId"><input id="zoneId" class="form-control" placeholder="Zone ID"></div>
                </div>
            </div>

            <!-- LOGIN -->
            <div id="formLogin" style="display:none">
                <input id="loginEmail" class="form-control mb-2" placeholder="Email / No HP">
                <input id="loginPass" type="password" class="form-control mb-2" placeholder="Password">
                <select id="loginVia" class="form-select">
                    <option>Moonton</option>
                    <option>Facebook</option>
                    <option>VK</option>
                    <option>TikTok</option>
                </select>
            </div>

            <hr>
            <div class="row g-2" id="itemGrid"></div>

            <hr>
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="checkReminder" onchange="toggleReminder()">
                <label class="form-check-label">Smart Reminder (Gratis)</label>
            </div>
            <div id="boxInputWa" style="display:none" class="mt-2">
                <input id="userWa" class="form-control" placeholder="Nomor WhatsApp">
            </div>

            <button class="btn-pay mt-3" onclick="kirimPesanan()">
                <i class="fa fa-wallet me-2"></i>Bayar Sekarang
            </button>
            </div>
        </div>
    </div>

    <script src="data.js"></script>

    <script>
        const ADMIN_WA = "628988889025";

        let currentGame="", selectedItem=null, selectedPrice=0, metodeInput="UID";

        function generateOrderID(){
        return "RZQ-"+Date.now().toString().slice(-6);
        }

        function initHome(){
            const c=document.getElementById("gameGridContainer");
            c.innerHTML="";
            for(const g in DATA_GAME){
                const d=DATA_GAME[g];
                c.innerHTML+=`
                <div class="col-4">
                <div class="game-grid-card" onclick='openOrderPage(${JSON.stringify(g)})'>
                <div class="game-img-wrapper"><img src="${d.image}"></div>
                <div class="game-title">${g}</div>
                </div>
                </div>`;
            }
        }

        function openOrderPage(game){
            currentGame=game;
            homePage.style.display="none";
            orderPage.style.display="block";
            selectedGameTitle.innerText=game;
            selectedGameImg.src=DATA_GAME[game].image;
            toggleMetode();
            cekJamOperasional();
        }

        function backToHome(){
            orderPage.style.display="none";
            homePage.style.display="block";
        }

        function toggleMetode(){
            metodeInput=metodeUid.checked?"UID":"LOGIN";
            formUid.style.display=metodeInput==="UID"?"block":"none";
            formLogin.style.display=metodeInput==="LOGIN"?"block":"none";
            updateItemGrid();
        }

        function updateItemGrid(){
            itemGrid.innerHTML="";
            const items=metodeInput==="UID"
            ?DATA_GAME[currentGame].items_uid
            :DATA_GAME[currentGame].items_login;

            items.forEach((it,i)=>{
                if(i===0){selectedItem=it.name;selectedPrice=it.price}
                itemGrid.innerHTML+=`
                <div class="col-6">
                <div class="item-card ${i===0?"active":""}"
                onclick="pilihItem(this,'${it.name}',${it.price})">
                <div class="fw-bold">${it.name}</div>
                <div class="text-info">Rp ${it.price.toLocaleString()}</div>
                </div>
                </div>`;
            });
        }

        function pilihItem(el,n,p){
            document.querySelectorAll(".item-card").forEach(x=>x.classList.remove("active"));
            el.classList.add("active");
            selectedItem=n;selectedPrice=p;
        }

        function toggleReminder(){
            boxInputWa.style.display=checkReminder.checked?"block":"none";
        }

        function cekJamOperasional(){
            const h=new Date().getHours();
            storeStatus.className="alert "+(h>=10&&h<22?"alert-success":"alert-danger");
            storeStatus.innerText=h>=10&&h<22?"TOKO BUKA":"TOKO TUTUP";
        }

        function kirimPesanan(){
            const orderID=generateOrderID();
            let akun="";

            if(metodeInput==="UID"){
                if(!userId.value)return Swal.fire("Error","User ID kosong","error");
                akun=`Metode: UID\nID: ${userId.value} ${zoneId.value||""}`;
            }else{
                if(!loginEmail.value||!loginPass.value)return Swal.fire("Error","Login kosong","error");
                akun=`Metode: LOGIN\nAkun: ${loginEmail.value}\nVia: ${loginVia.value}`;
            }

            let reminder="OFF";
            if(checkReminder.checked){
                if(!userWa.value)return Swal.fire("Error","Isi No WA","warning");
                reminder="ON - "+userWa.value;
            }

            let pesan=`ORDER BARU RIZIQSTORE
            Order ID: ${orderID}
            Game: ${currentGame}
            ${akun}
            Item: ${selectedItem}
            Harga: Rp ${selectedPrice.toLocaleString()}
            Reminder: ${reminder}

            Mohon diproses ðŸ™`;

            const encoded=encodeURIComponent(pesan);
            window.open(`https://wa.me/${ADMIN_WA}?text=${encoded}`,"_blank");

            loginPass.value=""; // HAPUS PASSWORD
        }

        initHome();
    </script>

</body>
</html>
